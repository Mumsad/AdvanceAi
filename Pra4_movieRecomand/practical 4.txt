Step 1: Required Files Download Karo

Aapko 2 CSV files chahiye:

1️⃣ movies.csv
2️⃣ ratings.csv

Download from MovieLens (25M dataset):
https://files.grouplens.org/datasets/movielens/ml-25m.zip

Zip extract karo → folder ke andar:

movies.csv

ratings.csv

In dono ko apne project folder me daal do.

✅ Step 2: Create a Project Folder

Example folder:

recommendation_project/
    ├── movies.csv
    ├── ratings.csv
    ├── recommender.py

✅ Step 3: VS Code Open Karo

VS Code open karo

File → Open Folder → recommendation_project select karo

✅ Step 4: Python Extension Install Karo

Left side Extensions icon → search:

Python


Install the one by Microsoft.

✅ Step 5: Python Interpreter Select Karo

Bottom-left corner pe “Python 3.x” dikhega → click karo → choose:

Python 3.x (Recommended)

✅ Step 6: Install Dependencies

VS Code terminal open:

Ctrl + `


Then run:

pip install pandas numpy scikit-learn ipywidgets
code :-
import pandas as pd
import numpy as np
import re
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

movies = pd.read_csv("movies.csv")
ratings = pd.read_csv("ratings.csv")

def clean_title(title):
    return re.sub("[^a-zA-Z0-9 ]", "", title)

movies["clean_title"] = movies["title"].apply(clean_title)

vectorizer = TfidfVectorizer(ngram_range=(1,2))
tfidf = vectorizer.fit_transform(movies["clean_title"])

def search(title):
    title = clean_title(title)
    query_vec = vectorizer.transform([title])
    similarity = cosine_similarity(query_vec, tfidf).flatten()
    indices = np.argpartition(similarity, -5)[-5:]
    return movies.iloc[indices].iloc[::-1]

def find_similar_movies(movie_id):
    similar_users = ratings[(ratings["movieId"] == movie_id) & (ratings["rating"] > 4)]["userId"].unique()
    similar_user_recs = ratings[(ratings["userId"].isin(similar_users)) & (ratings["rating"] > 4)]["movieId"]
    similar_user_recs = similar_user_recs.value_counts() / len(similar_users)

    similar_user_recs = similar_user_recs[similar_user_recs > .10]
    all_users = ratings[(ratings["movieId"].isin(similar_user_recs.index)) & (ratings["rating"] > 4)]
    all_user_recs = all_users["movieId"].value_counts() / len(all_users["userId"].unique())
    
    rec_percentages = pd.concat([similar_user_recs, all_user_recs], axis=1)
    rec_percentages.columns = ["similar", "all"]
    rec_percentages["score"] = rec_percentages["similar"] / rec_percentages["all"]
    
    rec_percentages = rec_percentages.sort_values("score", ascending=False)
    return rec_percentages.head(10).merge(movies, left_index=True, right_on="movieId")[["score","title","genres"]]

# ---- RUN ----
title = input("Enter a movie name: ")
results = search(title)
movie_id = results.iloc[0]["movieId"]
print("\nTop Recommendations:\n")
print(find_similar_movies(movie_id))
